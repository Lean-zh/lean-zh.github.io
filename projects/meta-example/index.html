<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://leanprover.cn/projects/meta-example/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.20"><title>Lean4 项目实战 - Lean Prover 中文文档</title><link rel=stylesheet href=../../assets/stylesheets/main.e53b48f4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/css/admonition-custom.css><link rel=stylesheet href=../../assets/css/custom.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=green data-md-color-accent=light-green> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#lean4 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Lean Prover 中文文档" class="md-header__button md-logo" aria-label="Lean Prover 中文文档" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Lean Prover 中文文档 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Lean4 项目实战 </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/Lean-zh/Lean-zh.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> Lean-zh </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> 主页 </a> </li> <li class=md-tabs__item> <a href=../verso/ class=md-tabs__link> 项目教程 </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Lean Prover 中文文档" class="md-nav__button md-logo" aria-label="Lean Prover 中文文档" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Lean Prover 中文文档 </label> <div class=md-nav__source> <a href=https://github.com/Lean-zh/Lean-zh.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> Lean-zh </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> 主页 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> 主页 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Lean-zh </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> 项目教程 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> 项目教程 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../verso/ class=md-nav__link> <span class=md-ellipsis> Verso 教程 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 创建项目 </span> </a> <nav class=md-nav aria-label=创建项目> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 创建的其他选项 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lake class=md-nav__link> <span class=md-ellipsis> Lake 项目配置详解 </span> </a> <nav class=md-nav aria-label="Lake 项目配置详解"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 基础配置文件 </span> </a> <nav class=md-nav aria-label=基础配置文件> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 添加模块 </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 修改版本 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 配置可执行程序 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 完整配置文件 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 项目代码实现 </span> </a> <nav class=md-nav aria-label=项目代码实现> <ul class=md-nav__list> <li class=md-nav__item> <a href=#hello-world class=md-nav__link> <span class=md-ellipsis> Hello World 程序实现 </span> </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 交互式程序 </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 编写元策略 </span> </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> 小结 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> 测试，自动化及发布 </span> </a> <nav class=md-nav aria-label=测试，自动化及发布> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> 测试配置 </span> </a> </li> <li class=md-nav__item> <a href=#_14 class=md-nav__link> <span class=md-ellipsis> 自动化 </span> </a> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> <span class=md-ellipsis> 项目发布 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=lean4>Lean4 项目实战<a class=headerlink href=#lean4 title="Permanent link">&para;</a></h1> <p><a href=../../tutorial/elan-lake/ >前文</a>介绍了 Lean 项目的基本结构和文件组织方式，也介绍了 Lean 开发的三件套工具：elan、lake 和 lean。这些工具组合类似于其他语言生态中的工具链，比如：</p> <ul> <li>Rust 中的 rustup + cargo + rustc</li> <li>Node.js 中的 nvm + npm + node</li> </ul> <p>本文将进行实战演练，完整体验 Lean 项目的开发流程，包括：</p> <ul> <li>项目创建</li> <li>依赖管理与配置</li> <li>终端交互和元编程策略编写</li> <li>测试，自动化以及收录相关</li> </ul> <p>相关代码可以在仓库找到：<a href=https://github.com/Lean-zh/MyTactics>Lean-zh/MyTactics</a>。</p> <p><strong>参考资源</strong></p> <ul> <li>元编程示例教程：<a href=https://github.com/siddhartha-gadgil/MetaExamples>MetaExamples</a></li> <li>Lean 中文文档：<a href=https://www.leanprover.cn/fp-lean-zh/ >函数式编程</a>，<a href=../../references/lake-doc/ >Lake 文档</a>以及 <a href=../../install/ >Lean4 安装指南</a></li> </ul> <p><strong>准备工作</strong></p> <p>在开始之前，请确保：</p> <ol> <li>已正确安装 Lean4 开发环境，可以在命令行中运行 <code>elan</code>、<code>lake</code> 和 <code>lean</code> 命令</li> <li>了解 Lean 项目的基本结构，熟悉 <code>lakefile.lean</code> 和 <code>lakefile.toml</code> 等配置文件的作用</li> </ol> <h2 id=_1>创建项目<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <p>首先创建一个新的 Lean 项目，命名为 <code>MyTactics</code>，并使用 Mathlib 作为依赖库。创建命令如下：</p> <div class=highlight><pre><span></span><code>lake<span class=w> </span>new<span class=w> </span>MyTactics<span class=w> </span>math.lean
</code></pre></div> <p>执行完成后，将生成如下项目结构：</p> <div class=highlight><pre><span></span><code>MyTactics/
├──<span class=w> </span>MyTactics/
│<span class=w>   </span>└──<span class=w> </span>Basic.lean<span class=w>    </span><span class=c1># 基础模块文件</span>
├──<span class=w> </span>MyTactics.lean<span class=w>    </span><span class=c1># 主模块文件</span>
├──<span class=w> </span>README.md<span class=w>         </span><span class=c1># 项目说明文档</span>
├──<span class=w> </span>lakefile.lean<span class=w>     </span><span class=c1># Lake 构建配置文件</span>
└──<span class=w> </span>lean-toolchain<span class=w>    </span><span class=c1># Lean 工具链版本配置</span>
</code></pre></div> <h3 id=_2>创建的其他选项<a class=headerlink href=#_2 title="Permanent link">&para;</a></h3> <p>Lake 提供了多种项目创建选项：</p> <div class=highlight><pre><span></span><code><span class=c1># 使用 TOML 格式的依赖配置文件</span>
lake<span class=w> </span>new<span class=w> </span>MyTactics<span class=w> </span>math.toml

<span class=c1># 创建不依赖 Mathlib 的纯 Lean 项目</span>
lake<span class=w> </span>new<span class=w> </span>MyTactics<span class=w> </span>.lean

<span class=c1># 使用指定版本的 Lean 创建项目</span>
elan<span class=w> </span>run<span class=w> </span>leanprover/lean4:v4.10.0<span class=w> </span>lake<span class=w> </span>new<span class=w> </span>MyTactics<span class=w> </span>.lean
</code></pre></div> <p>特别注意，当使用 Mathlib 作为依赖时，新建项目会自动使用最新的 Lean 版本，这个行为与执行创建命令时的 Lake 版本无关。需手动修改 <code>lean-toolchain</code> 文件中的版本号。</p> <h2 id=lake>Lake 项目配置详解<a class=headerlink href=#lake title="Permanent link">&para;</a></h2> <h3 id=_3>基础配置文件<a class=headerlink href=#_3 title="Permanent link">&para;</a></h3> <p>生成的 <code>lakefile.lean</code> 包含以下主要配置：</p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=n>Lake</span>
<span class=kn>open</span><span class=w> </span><span class=n>Lake</span><span class=w> </span><span class=n>DSL</span>

<span class=n>package</span><span class=w> </span><span class=s2>&quot;MyTactics&quot;</span><span class=w> </span><span class=n>where</span>
<span class=w>  </span><span class=c1>-- Settings applied to both builds and interactive editing</span>
<span class=w>  </span><span class=n>leanOptions</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=bp>#</span><span class=o>[</span>
<span class=w>    </span><span class=o>⟨</span><span class=ss>`pp.unicode.fun</span><span class=o>,</span><span class=w> </span><span class=n>true</span><span class=o>⟩</span><span class=w> </span><span class=c1>-- pretty-prints `fun a ↦ b`</span>
<span class=w>  </span><span class=o>]</span>
<span class=w>  </span><span class=c1>-- add any additional package configuration options here</span>

<span class=n>require</span><span class=w> </span><span class=s2>&quot;leanprover-community&quot;</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=s2>&quot;mathlib&quot;</span>

<span class=kd>@[</span><span class=n>default_target</span><span class=kd>]</span>
<span class=n>lean_lib</span><span class=w> </span><span class=bp>«</span><span class=n>MyTactics</span><span class=bp>»</span><span class=w> </span><span class=n>where</span>
<span class=w>  </span><span class=c1>-- add any library configuration options here</span>
</code></pre></div> <p>配置文件分为三个主要部分：</p> <ol> <li> <p><strong>包信息设置</strong>（package）： <div class=highlight><pre><span></span><code><span class=n>package</span><span class=w> </span><span class=s2>&quot;MyTactics&quot;</span><span class=w> </span><span class=n>where</span>
<span class=w>  </span><span class=n>leanOptions</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=bp>#</span><span class=o>[</span>
<span class=w>    </span><span class=o>⟨</span><span class=ss>`pp.unicode.fun</span><span class=o>,</span><span class=w> </span><span class=n>true</span><span class=o>⟩</span>
<span class=w>  </span><span class=o>]</span>
</code></pre></div></p> </li> <li> <p><strong>依赖项声明</strong>（require）： <div class=highlight><pre><span></span><code><span class=n>require</span><span class=w> </span><span class=s2>&quot;leanprover-community&quot;</span><span class=w> </span><span class=bp>/</span><span class=w> </span><span class=s2>&quot;mathlib&quot;</span>
</code></pre></div></p> </li> <li> <p><strong>构建目标设置</strong>（lean_lib）： <div class=highlight><pre><span></span><code><span class=kd>@[</span><span class=n>default_target</span><span class=kd>]</span>
<span class=n>lean_lib</span><span class=w> </span><span class=bp>«</span><span class=n>MyTactics</span><span class=bp>»</span><span class=w> </span><span class=n>where</span>
</code></pre></div> <code>@[default_target]</code> 表示这是默认构建目标，使用 <code>lake build</code> 时会自动构建。</p> </li> </ol> <h4 id=_4>添加模块<a class=headerlink href=#_4 title="Permanent link">&para;</a></h4> <p>每个 <code>lean_lib</code> 声明都需要对应实际的 Lean 文件，比如添加</p> <div class=highlight><pre><span></span><code><span class=n>lean_lib</span><span class=w> </span><span class=bp>«</span><span class=n>Hello</span><span class=bp>»</span><span class=w> </span><span class=n>where</span>
</code></pre></div> <p>则需在项目目录下添加 <code>Hello.lean</code> 文件。此外，可以用文件夹组织项目代码，例如 <code>Hello/greet.lean</code> 文件通过 <code>import Hello.greet</code> 导入。</p> <h4 id=_5>修改版本<a class=headerlink href=#_5 title="Permanent link">&para;</a></h4> <p>如果引用了 Mathlib，建议使用以下配置，确保 Mathlib 版本与项目一致，避免构建错误。</p> <div class=highlight><pre><span></span><code><span class=n>require</span><span class=w> </span><span class=n>mathlib</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>git</span>
<span class=w>  </span><span class=s2>&quot;https://github.com/leanprover-community/mathlib4.git&quot;</span><span class=w> </span><span class=bp>@</span><span class=w> </span><span class=n>s</span><span class=bp>!</span><span class=s2>&quot;v{Lean.versionString}&quot;</span>
</code></pre></div> <p>这里 <code>s!"v{Lean.versionString}"</code> 会读取仓库当前的 Lean 版本。</p> <h3 id=_6>配置可执行程序<a class=headerlink href=#_6 title="Permanent link">&para;</a></h3> <p>在 Lean 生态中，很多项目都会提供可执行程序，例如：</p> <ul> <li><code>lake exe cache get</code>：用于拉取 Mathlib 的构建缓存</li> <li><code>lake env jixia</code>：运行 <a href=https://github.com/frenzymath/jixia>JiXia</a> 的数据分析工具</li> <li><code>lake env repl</code>：启动 Lean 的 REPL 环境</li> </ul> <p>这些可执行命令通过 <code>lakefile.lean</code> 中的 <code>lean_exe</code> 参数进行配置。让我们在项目中添加两个可执行程序的配置：</p> <div class=highlight><pre><span></span><code><span class=n>lean_exe</span><span class=w> </span><span class=s2>&quot;hello&quot;</span><span class=w> </span><span class=n>where</span>
<span class=w>  </span><span class=n>root</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=ss>`Hello.Greet</span>

<span class=kd>@[</span><span class=n>default_target</span><span class=kd>]</span>
<span class=n>lean_exe</span><span class=w> </span><span class=s2>&quot;demo&quot;</span><span class=w> </span><span class=n>where</span>
<span class=w>  </span><span class=n>root</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=ss>`Demo</span>
</code></pre></div> <p>同样地，被 <code>@[default_target]</code> 标记的目标会在执行 <code>lake build</code> 时自动构建，无需显式执行 <code>lake build demo</code>。</p> <p>除了 <code>lean_exe</code> 模块外，也可以用 <code>script</code> 字段定义脚本。例如：</p> <div class=highlight><pre><span></span><code><span class=n>script</span><span class=w> </span><span class=s2>&quot;greet&quot;</span><span class=w> </span><span class=o>(</span><span class=n>args</span><span class=o>)</span><span class=w> </span><span class=k>do</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=n>args.length</span><span class=w> </span><span class=k>then</span>
<span class=w>    </span><span class=n>IO.println</span><span class=w> </span><span class=n>s</span><span class=bp>!</span><span class=s2>&quot;Hello, {args[0]&#39;h}!&quot;</span>
<span class=w>  </span><span class=k>else</span>
<span class=w>    </span><span class=n>IO.println</span><span class=w> </span><span class=s2>&quot;Hello, world!&quot;</span>
<span class=w>  </span><span class=n>return</span><span class=w> </span><span class=mi>0</span>
</code></pre></div> <p>运行 <code>lake script greet</code> 命令运行该脚本。</p> <h3 id=_7>完整配置文件<a class=headerlink href=#_7 title="Permanent link">&para;</a></h3> <p>到这里，我们初始化了一个 Lean 项目，并根据需求修改了依赖。完整的 <code>lakefile.lean</code> 内容如下：</p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=n>Lake</span>
<span class=kn>open</span><span class=w> </span><span class=n>Lake</span><span class=w> </span><span class=n>DSL</span>

<span class=n>package</span><span class=w> </span><span class=s2>&quot;MyTactics&quot;</span><span class=w> </span><span class=n>where</span>
<span class=w>  </span><span class=c1>-- Settings applied to both builds and interactive editing</span>
<span class=w>  </span><span class=n>leanOptions</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=bp>#</span><span class=o>[</span>
<span class=w>    </span><span class=o>⟨</span><span class=ss>`pp.unicode.fun</span><span class=o>,</span><span class=w> </span><span class=n>true</span><span class=o>⟩</span><span class=w> </span><span class=c1>-- pretty-prints `fun a ↦ b`</span>
<span class=w>  </span><span class=o>]</span>
<span class=w>  </span><span class=c1>-- add any additional package configuration options here</span>

<span class=n>require</span><span class=w> </span><span class=n>mathlib</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>git</span>
<span class=w>  </span><span class=s2>&quot;https://github.com/leanprover-community/mathlib4.git&quot;</span><span class=w> </span><span class=bp>@</span><span class=w> </span><span class=n>s</span><span class=bp>!</span><span class=s2>&quot;v{Lean.versionString}&quot;</span>

<span class=kd>@[</span><span class=n>default_target</span><span class=kd>]</span>
<span class=n>lean_lib</span><span class=w> </span><span class=bp>«</span><span class=n>MyTactics</span><span class=bp>»</span><span class=w> </span><span class=n>where</span>
<span class=w>  </span><span class=c1>-- add any library configuration options here</span>

<span class=n>lean_lib</span><span class=w> </span><span class=bp>«</span><span class=n>Hello</span><span class=bp>»</span><span class=w> </span><span class=n>where</span>

<span class=n>lean_exe</span><span class=w> </span><span class=s2>&quot;hello&quot;</span><span class=w> </span><span class=n>where</span>
<span class=w>  </span><span class=n>root</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=ss>`Hello.Greet</span>

<span class=kd>@[</span><span class=n>default_target</span><span class=kd>]</span>
<span class=n>lean_exe</span><span class=w> </span><span class=s2>&quot;demo&quot;</span><span class=w> </span><span class=n>where</span>
<span class=w>  </span><span class=n>root</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=ss>`Demo</span>
</code></pre></div> <p>配置完成后的项目结构：</p> <div class=highlight><pre><span></span><code>MyTactics/
├──<span class=w> </span>Demo.lean<span class=w>           </span><span class=c1># 演示程序主文件</span>
├──<span class=w> </span>Hello/
│<span class=w>   </span>└──<span class=w> </span>Greet.lean<span class=w>     </span><span class=c1># Hello 程序实现</span>
├──<span class=w> </span>Hello.lean<span class=w>         </span><span class=c1># Hello 模块主文件</span>
├──<span class=w> </span>MyTactics/
│<span class=w>   </span>└──<span class=w> </span>Basic.lean<span class=w>     </span><span class=c1># 基础功能实现</span>
├──<span class=w> </span>MyTactics.lean<span class=w>     </span><span class=c1># 主模块文件</span>
├──<span class=w> </span>README.md<span class=w>          </span><span class=c1># 项目文档</span>
├──<span class=w> </span>lake-manifest.json<span class=w> </span><span class=c1># Lake 依赖清单</span>
├──<span class=w> </span>lakefile.lean<span class=w>      </span><span class=c1># Lake 配置文件</span>
└──<span class=w> </span>lean-toolchain<span class=w>     </span><span class=c1># Lean 版本配置</span>
</code></pre></div> <p>添加了自定义的 <code>Hello/Greet.lean</code> 文件和 <code>Demo.lean</code> 文件。</p> <p>接下来我们将开始编写具体的实现代码。</p> <h2 id=_8>项目代码实现<a class=headerlink href=#_8 title="Permanent link">&para;</a></h2> <p>在完成项目配置后，我们开始编写具体的代码实现。本节将分三个部分展示：</p> <ol> <li>Hello World 程序</li> <li>交互式程序</li> <li>元编程策略</li> </ol> <h3 id=hello-world>Hello World 程序实现<a class=headerlink href=#hello-world title="Permanent link">&para;</a></h3> <p>作为程序员的传统，先从最基础的 Hello World 程序开始。</p> <p>编写 <code>Hello/Greet.lean</code> 文件：</p> <div class=highlight><pre><span></span><code><span class=kd>def</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s2>&quot;Rex&quot;</span>
<span class=kd>def</span><span class=w> </span><span class=n>main</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>IO</span><span class=w> </span><span class=n>Unit</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=n>IO.println</span><span class=w> </span><span class=n>s</span><span class=bp>!</span><span class=s2>&quot;Hello, {name}!&quot;</span>
</code></pre></div> <p>然后在 <code>Hello.lean</code> 中导入模块：</p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=n>Hello.Greet</span>
</code></pre></div> <p>可以通过以下几种方式运行程序：</p> <ol> <li><code>lake exe hello</code>：重新构建并运行</li> <li><code>lake env hello</code>：直接运行已构建的程序</li> <li><code>lean --run Hello/Greet.lean</code>：直接执行脚本的 <code>main</code> 函数</li> </ol> <p>下图展示了 <code>lake exe</code> 和 <code>lake env</code> 的区别：</p> <p><img alt=lake-hello src=../../assets/imgs/lake-hello.svg></p> <blockquote> <p>💡 <strong>关于 Lean 中的副作用</strong></p> <p>Lean 的计算模型基于表达式求值，理论上是纯函数式的，不存在副作用（side effects）。 但现实中程序需要与外部世界交互，Lean 通过 <code>IO</code> 类型优雅地解决了这个问题：</p> <ul> <li><code>main</code> 函数的类型 <code>IO Unit</code> 表明它不是一个直接产生副作用的函数</li> <li>而是一个描述了 IO 操作的声明性表达</li> <li>可以将 IO 操作视为一个接收"整个世界"作为输入，并返回新的世界状态的纯函数</li> </ul> <p>更多关于 Lean 函数式编程的讨论，可以参考 <a href=https://www.leanprover.cn/fp-lean-zh/hello-world/running-a-program.html>Lean 函数式编程指南</a>。</p> </blockquote> <h3 id=_9>交互式程序<a class=headerlink href=#_9 title="Permanent link">&para;</a></h3> <p>下边演示 Lean 如何处理用户输入。</p> <p>创建 <code>Demo.lean</code> 文件，实现一个多行文本的拼接程序：</p> <div class=highlight><pre><span></span><code><span class=sd>/-- 递归读取用户输入，直到遇到空行为止 -/</span>
<span class=n>partial</span><span class=w> </span><span class=kd>def</span><span class=w> </span><span class=n>getLines</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>IO</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>do</span>
<span class=w>  </span><span class=n>IO.print</span><span class=w> </span><span class=s2>&quot;Enter your text: &quot;</span>
<span class=w>  </span><span class=k>let</span><span class=w> </span><span class=n>line</span><span class=w> </span><span class=bp>←</span><span class=w> </span><span class=o>(</span><span class=bp>←</span><span class=w> </span><span class=n>IO.getStdin</span><span class=o>)</span><span class=bp>.</span><span class=n>getLine</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=n>line.trim.isEmpty</span><span class=w> </span><span class=k>then</span>
<span class=w>    </span><span class=n>return</span><span class=w> </span><span class=n>line.trimRight</span>
<span class=w>  </span><span class=k>else</span>
<span class=w>    </span><span class=n>return</span><span class=w> </span><span class=n>line.trimRight</span><span class=w> </span><span class=bp>++</span><span class=w> </span><span class=o>(</span><span class=bp>←</span><span class=w> </span><span class=n>getLines</span><span class=o>)</span>

<span class=sd>/-- 主程序：读取并拼接多行输入 -/</span>
<span class=kd>def</span><span class=w> </span><span class=n>main</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>IO</span><span class=w> </span><span class=n>Unit</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>do</span>
<span class=w>  </span><span class=k>let</span><span class=w> </span><span class=n>stdin</span><span class=w> </span><span class=bp>←</span><span class=w> </span><span class=n>getLines</span>
<span class=w>  </span><span class=n>IO.println</span><span class=w> </span><span class=n>s</span><span class=bp>!</span><span class=s2>&quot;Concatenated lines: {stdin}&quot;</span>
</code></pre></div> <p>这里 <code>partial</code> 关键字用于声明递归函数 <code>getLines</code>，告诉 Lean 编译器不需要验证函数的终止性。执行效果：</p> <p><img alt=lake-demo src=../../assets/imgs/lake-demo.svg></p> <p>Lean 社区的 <a href=../../tool/repl/ >REPL</a> 就是基于类似的机制实现 Lean 与外部环境的信息交流。</p> <h3 id=_10>编写元策略<a class=headerlink href=#_10 title="Permanent link">&para;</a></h3> <p>在自定义元策略之前，先了解两个常用的 tactic：</p> <ol> <li><code>repeat</code>：重复执行某个策略直到证明完成</li> <li><code>first | tac₁ | tac₂ | ...</code>：按顺序依此尝试策略，任一成功即停止，否则报错</li> </ol> <p>通过一道证明题来说明这些策略的用法：</p> <div class=highlight><pre><span></span><code><span class=c1>-- 逐步证明 2 ≤ 6</span>
<span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=mi>6</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>Nat.le_step</span><span class=w> </span><span class=c1>-- 2 ≤ 5</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>Nat.le_step</span><span class=w> </span><span class=c1>-- 2 ≤ 4</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>Nat.le_step</span><span class=w> </span><span class=c1>-- 2 ≤ 3</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>Nat.le_step</span><span class=w> </span><span class=c1>-- 2 ≤ 2</span>
<span class=w>  </span><span class=n>apply</span><span class=w> </span><span class=n>Nat.le_refl</span><span class=w> </span><span class=c1>-- 完成证明</span>

<span class=c1>-- ❌ 单独使用 repeat 无法完成证明</span>
<span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=mi>6</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>repeat</span><span class=w> </span><span class=o>(</span><span class=n>apply</span><span class=w> </span><span class=n>Nat.le_step</span><span class=o>)</span>

<span class=c1>-- ✅ 组合使用 repeat 和 first 完成证明</span>
<span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=mi>6</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>repeat</span><span class=w> </span><span class=o>(</span><span class=n>first</span><span class=w> </span><span class=bp>|</span><span class=w> </span><span class=n>apply</span><span class=w> </span><span class=n>Nat.le_refl</span><span class=w> </span><span class=bp>|</span><span class=w> </span><span class=n>apply</span><span class=w> </span><span class=n>Nat.le_step</span><span class=o>)</span>
</code></pre></div> <p><code>repeat</code> 这一长串显然不太优雅，为了简化类似的证明过程，我们定义一个元策略：</p> <div class=highlight><pre><span></span><code><span class=sd>/-- </span>
<span class=sd>重复应用两个策略直到证明完成</span>
<span class=sd>参数：</span>
<span class=sd>- t₁: 第一个要应用的定理</span>
<span class=sd>- t₂: 第二个要应用的定理</span>
<span class=sd>-/</span>
<span class=n>macro</span><span class=w> </span><span class=s2>&quot;repeat_apply&quot;</span><span class=w> </span><span class=n>t₁</span><span class=o>:</span><span class=n>term</span><span class=w> </span><span class=s2>&quot;or&quot;</span><span class=w> </span><span class=n>t₂</span><span class=o>:</span><span class=n>term</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>tactic</span><span class=w> </span><span class=bp>=&gt;</span><span class=w> </span>
<span class=w>  </span><span class=bp>`</span><span class=o>(</span><span class=n>tactic</span><span class=w> </span><span class=bp>|</span><span class=w> </span><span class=n>repeat</span><span class=w> </span><span class=o>(</span><span class=n>first</span><span class=w> </span><span class=bp>|</span><span class=w> </span><span class=n>apply</span><span class=w> </span><span class=bp>$</span><span class=n>t₁</span><span class=w> </span><span class=bp>|</span><span class=w> </span><span class=n>apply</span><span class=w> </span><span class=bp>$</span><span class=n>t₂</span><span class=o>))</span>
</code></pre></div> <p>将内容写入 <code>MyTactics/Basic.lean</code> 文件，并在 <code>MyTactics.lean</code> 中导入：</p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=n>MyTactics.Basic</span>
</code></pre></div> <p>之后通过 <code>import MyTactics</code> 即可在其他文件中使用该策略。</p> <p><strong>使用示例</strong></p> <p>现在，前边的例子可以这样写：</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=bp>≤</span><span class=w> </span><span class=mi>6</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>repeat_apply</span><span class=w> </span><span class=n>Nat.le_refl</span><span class=w> </span><span class=n>or</span><span class=w> </span><span class=n>Nat.le_step</span>
</code></pre></div> <p>或者用于证明其他类似式子：</p> <div class=highlight><pre><span></span><code><span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>30</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>39</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>repeat_apply</span><span class=w> </span><span class=n>Nat.le_refl</span><span class=w> </span><span class=n>or</span><span class=w> </span><span class=n>Nat.le_step</span>

<span class=kd>example</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>30</span><span class=w> </span><span class=bp>&lt;</span><span class=w> </span><span class=mi>40</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kd>by</span>
<span class=w>  </span><span class=n>repeat_apply</span><span class=w> </span><span class=n>Nat.succ_le_succ</span><span class=w> </span><span class=n>or</span><span class=w> </span><span class=n>Nat.zero_le</span>
</code></pre></div> <h3 id=_11>小结<a class=headerlink href=#_11 title="Permanent link">&para;</a></h3> <p>我们演示了三个例子：</p> <ol> <li>Hello World 程序：<code>Hello/Greet.lean</code></li> <li>如何处理用户输入：<code>Demo.lean</code></li> <li>元策略示例：<code>MyTactics/Basic.lean</code></li> </ol> <h2 id=_12>测试，自动化及发布<a class=headerlink href=#_12 title="Permanent link">&para;</a></h2> <h3 id=_13>测试配置<a class=headerlink href=#_13 title="Permanent link">&para;</a></h3> <p>最基本的测试配置是在 <code>lakefile.lean</code> 中使用 <code>@[test_driver]</code> 标记测试模块。</p> <p>比如标记 <code>lean_exe</code> 模块：</p> <div class=highlight><pre><span></span><code><span class=kd>@[</span><span class=n>test_driver</span><span class=kd>]</span>
<span class=n>lean_exe</span><span class=w> </span><span class=n>test</span><span class=w> </span><span class=o>{</span>
<span class=w>  </span><span class=n>root</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=ss>`Tests.Main</span>
<span class=o>}</span>
</code></pre></div> <p>然后在 <code>Tests/Main.lean</code> 中实现测试逻辑：</p> <div class=highlight><pre><span></span><code><span class=kd>def</span><span class=w> </span><span class=n>main</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>IO</span><span class=w> </span><span class=n>Unit</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>do</span>
<span class=w>  </span><span class=c1>-- 测试用例实现</span>
<span class=w>  </span><span class=n>IO.println</span><span class=w> </span><span class=s2>&quot;Running tests...&quot;</span>
<span class=w>  </span><span class=c1>-- 测试代码</span>
</code></pre></div> <p>使用 <code>lake test</code> 命令运行所有标记为测试的模块。</p> <p>此外，也可以直接编写 shell 脚本，REPL 项目就是这么做的。当然，也有用于 Lean 测试的项目 <a href=https://github.com/argumentcomputer/LSpec>LSpec</a>，后续再进一步探索。</p> <h3 id=_14>自动化<a class=headerlink href=#_14 title="Permanent link">&para;</a></h3> <p>自动化方面，这里贴一个 GitHub Workflow 供参考。当向 <code>main</code> 分支提交 PR 或者推送代码时触发。</p> <div class=highlight><pre><span></span><code><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Run Tests</span>

<span class=nt>on</span><span class=p>:</span>
<span class=w>  </span><span class=nt>push</span><span class=p>:</span>
<span class=w>    </span><span class=nt>branches</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
<span class=w>  </span><span class=nt>pull_request</span><span class=p>:</span>
<span class=w>    </span><span class=nt>branches</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">main</span>

<span class=nt>jobs</span><span class=p>:</span>
<span class=w>  </span><span class=nt>test</span><span class=p>:</span>
<span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class=w>    </span><span class=nt>steps</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Checkout code</span>
<span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v2</span>

<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">install elan</span>
<span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span>
<span class=w>        </span><span class=no>set -o pipefail</span>
<span class=w>        </span><span class=no>curl -sSfL https://github.com/leanprover/elan/releases/download/v4.0.0/elan-x86_64-unknown-linux-gnu.tar.gz | tar xz</span>
<span class=w>        </span><span class=no>./elan-init -y --default-toolchain none</span>
<span class=w>        </span><span class=no>echo &quot;$HOME/.elan/bin&quot; &gt;&gt; $GITHUB_PATH</span>

<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">lake build</span>

<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Run tests</span>
<span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">lake test</span>
</code></pre></div> <h3 id=_15>项目发布<a class=headerlink href=#_15 title="Permanent link">&para;</a></h3> <p>目前 Lean 生态系统还没有类似 Python 的 PyPI 这样的包注册表，无法通过类似 <code>pip install</code> 的方式直接安装包。Lean 项目主要通过 GitHub 托管和分发，使用 git 方式拉取依赖。</p> <p>但是社区有个 <a href=https://reservoir.lean-lang.org/ >Reservoir 网站</a> 作为包索引平台，提供包的集中展示、构建测试和兼容性验证。收录项目需满足：</p> <ol> <li>公开的原创 GitHub 仓库（不接受 fork 或模板生成）</li> <li>根目录包含 <code>lake-manifest.json</code> 文件</li> <li>使用 OSI 认证的开源许可证</li> <li>GitHub 仓库至少获得 2 个星标</li> </ol> <p>如果项目满足这些条件，可以通过在 Reservoir 仓库提交 issue 申请收录，增加项目在社区的曝光度。</p> <p>以上，欢迎讨论交流～</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.instant", "search.highlight", "search.share", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>